<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/handlebars@latest/dist/handlebars.js"></script>
    <script src="/static/js/script.js"></script>
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
<p id="dPS"></p>

<form th:action="@{/logout}" method="post">
    <input type="submit" value="Sign Out"/>
</form>

<script>

    function renderHabitItems() {
        $.getJSON('http://localhost:8080/get_habits', function (data) {
            let template = $("#items").html();
            let compiledTemplate = Handlebars.compile(template);
            let text = compiledTemplate({"habits": data});
            $("#dPS").html(text);
            $(".icon").click(function (event){
                if ($(event.currentTarget).hasClass("enabled")) {
                    $(event.currentTarget).removeClass("enabled");
                    $(event.currentTarget).addClass("disabled");
                } else {
                    $(event.currentTarget).removeClass("disabled");
                    $(event.currentTarget).addClass("enabled");
                }
            });
        })
    }

    $(function () {
        renderHabitItems();
    });



</script>

<script id="items" type="text/template">
    <dl>
        {{#habits}}
        <dt>
            {{#fori 0 perDay}}
            <div class="icon {{icon}} disabled"></div>
            {{/fori}}
        </dt>
        {{/habits}}
    </dl>
</script>

</body>
</html>